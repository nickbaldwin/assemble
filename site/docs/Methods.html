<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <title> Methods  | Assemble</title>
    <link rel="stylesheet" href="../assets/css/assemble.css">
    <link rel="stylesheet" href="../assets/css/github.css">
  </head>
  <body style="background: white">

    <!-- navigation
    ================================================== -->
    
<div class="navbar">
  <div class="container">
    <!--<a class="navbar-brand" href="../index.html">ASSEMBLE</a> -->
    <a class="navbar-brand" href="../../index.html">ASSEMBLE</a>
    <button class="navbar-toggle" type="button" data-toggle="collapse" data-target=".bs-navbar-collapse">
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <div class="nav-collapse collapse bs-navbar-collapse">
      <ul class="nav navbar-nav">
        <li>
          <a href="../docs/Home.html">Docs</a>
        </li>
        <li>
          <a href="../../site/examples.html">Examples</a>
        </li>
      </ul>
      <ul class="nav navbar-nav pull-right">
        <li>
          <a href="../../site/blog.html">Blog</a>
        </li>
        <li> <a href="https://github.com/assemble/assemble/">GitHub Repo</a> </li>
      </ul>
    </div>
  </div>
</div>




    <!-- Subhead
    ================================================== -->
    <header class="masthead subhead">
      <div class="container">
        <div class="row">
          <div class="col col-lg-12">
            <h1><span class="text-muted">Docs /</span> configuration </h1>
          </div>
        </div>
      </div>
    </header>

    <!-- Content
    ================================================== -->
    <div class="container">
      <div class="row">
        <div class="col col-lg-3">
          <div class="sidebar">
            <span class="nav-section-title">
              Documentation
            </span>
            <ul class="nav nav-pills nav-stacked">
              
              <li><a href="About.html">About</a></li>
              <li><a href="Context.html">Context</a></li>
              <li><a href="External-Libraries.html">External Libraries</a></li>
              <li><a href="Getting-Started.html">Getting Started</a></li>
              <li><a href="Home.html">Table of Contents</a></li>
              <li><a href="Layouts.html">Layouts</a></li>
              <li class="active"><a href="Methods.html">Methods</a></li>
              <li><a href="Options.html">Options</a></li>
              <li><a href="Variables.html">Variables</a></li>
              <li><a href="YAML.html">YAML</a></li>
              <li><a href="options-assets.html">options.assets</a></li>
              <li><a href="options-collections.html">options.collections</a></li>
              <li><a href="options-data.html">options.data</a></li>
              <li><a href="options-ext.html">options.ext</a></li>
              <li><a href="options-helpers.html">options.helpers</a></li>
              <li><a href="options-layout.html">options.layout</a></li>
            </ul>
          </div>
        </div>
        <div class="col col-lg-9">
          <div class="panel panel-docs">

            <h1>Methods</h1>

            <h2>The &quot;assemble&quot; object</h2>
<p>Methods to the assemble object can be created using:</p>
<pre><code class="lang-javascript">var assemble = require(&#39;assemble&#39;).init(this);</code></pre>
<ul>
<li>the <code>this</code> object is from the grunt task, and can be accessed in assemble &quot;steps&quot; through <code>assemble.task</code></li>
<li>the <code>init</code> method does some initial option configuration and sets the following properties on the assemble object:</li>
</ul>
<pre><code class="lang-javascript">assemble.task;    // refers to the grunt task
assemble.options; // refers to the task.options merged with assemble defaults
assemble.files;   // refers to the task.files</code></pre>
<h3><code>init</code> method</h3>
<p>Describes <code>init</code> method to <code>assemble.engine</code>, and exposes engine on <code>assemble.engine</code>.</p>
<h4>Custom Engines</h4>
<p>If you don&#39;t wish to use Handlebars as your templates engine, you may add your own engine by providing an <code>init</code> function that takes in options from the assemble task/target. You may also override the <code>init</code> function in the task/target options by providing an <code>initializeEngine</code> function that takes the engine and the options:</p>
<pre><code class="lang-js">assemble: {
  options: {
    engine: &#39;consolidate&#39;,
    initializeEngine: function(engine, options) {
      engine.engine.swig.init(options);
    }
  },
  docs: {
    files: {
      &#39;docs/&#39;: [&#39;src/templates/**/*.tmpl&#39;]
    }
  }
}</code></pre>
<p>Assemble will attempt to load an engine and automatically add it&#39;s own wrapper methods around it while holding an instance of the engine. This is a way for engine plugin authors to write adapters between other engines and assemble&#39;s wrapper. To make these functions on the options useful, we&#39;ve exposed the underlying engine through the <code>assemble.engine</code> object so <strong>developers can use the raw engine</strong>. </p>
<p>This is particularly useful when <strong>a)</strong> a library such as <a href="https://github.com/visionmedia/consolidate.js/">consolidate</a> is used, where the engine is <code>consolidate</code>, and <strong>b)</strong> the developer wants to use another engine such as <a href="https://github.com/wycats/handlebars.js">handlebars</a>, <a href="https://github.com/paularmstrong/swig">swig</a>, <a href="https://github.com/janl/mustache.js">mustache</a> etc.</p>
<ul>
<li>The <code>init</code> function allows assemble to pass in options to be used in initializing this engine plugin.</li>
<li><code>init</code> function is exposed, and <a href="https://github.com/assemble/helper-lib">helper-lib</a> is registered inside the init so that options can be passed in.</li>
</ul>
<p>Admittedly, the <code>engine.engine</code> syntax is strange. This is &quot;alpha&quot;, so feedback and pull requests are especially welcome if you have ideas for improving this.</p>
<h4>Register Helpers</h4>
<p>Call <code>registerFunctions</code> by passing in an engine. This is used if you need to register custom <strong>helpers or &quot;filters&quot;, etc.</strong> beyond the helpers included in <a href="http://github.com/assemble/helper-lib">helper-lib</a>:</p>
<pre><code class="lang-javascript">registerFunctions(assemble.engine);</code></pre>
<p>Example of how this would be setup in the <code>options</code> of the assemble task or target:</p>
<pre><code class="lang-javascript">assemble: {
  options: {
    registerFunctions: function(engine) {
      var helperFunctions = {};
      helperFunctions[&#39;foo&#39;] = function() { return &#39;bar&#39;; };
      engine.engine.registerFunctions(helperFunctions);
    }
  },
  site: {
    files: {
      &#39;dist/&#39;: [&#39;src/templates/**/*.tmpl&#39;]
    }
  }
}</code></pre>
<h4>Register Partials</h4>
<p>Call <code>registerPartial</code> by passing in an engine:</p>
<pre><code class="lang-javascript">registerPartial(assemble.engine, &#39;partialName&#39;, content);</code></pre>
<p>Example of how this would be setup in the <code>options</code> of the assemble task or target:</p>
<pre><code class="lang-javascript">assemble: {
  options: {
    registerPartial: function(engine, name, content) {
      var tmpl = engine.compile(content);
      engine.engine.registerPartial(name, tmpl);
    }
  },
  blog: {
    files: {
      &#39;dist/blog/&#39;: [&#39;src/templates/**/*.tmpl&#39;]
    }
  }
}</code></pre>
<h3>assemble steps</h3>
<p>There are also methods to setup the assemble steps, and then execute the build:</p>
<p>The <code>step</code> function takes a function which takes 2 parameters <code>function(assemble, next)</code> :</p>
<ol>
<li><code>assemble</code> is the actual assemble object</li>
<li><code>next</code> is a callback function that needs to be called when finished executing this step</li>
</ol>
<p>See the following example:</p>
<pre><code class="lang-javascript">assemble.step(function(assemble, next) {
  // do some code here
  // you can add properties to assemble which can be accessed in later steps
  assemble.myCustomProperty = { foo: &#39;bar&#39; };

  // always call next when finished and pass back the assemble object
  next(assemble);
});</code></pre>
<h4>the <code>step</code> function</h4>
<p>The <code>step</code> function also returns the current assemble object so it&#39;s chainable...</p>
<pre><code class="lang-javascript">var assemble = require(&#39;assemble&#39;).init(this)
    .step(step1)
    .step(step2)
    .step(step3)
    .build(done);
`</code></pre>
<h4>the <code>build</code> function</h4>
<p>The <code>build</code> function takes a callback that is called when the build process is complete. The build process calls the steps that were previously setup, passing in the <code>assemble</code> object.</p>
<pre><code class="lang-javascript">assemble.build(function(err, result) {
  if(err) {
    console.log(err);
    return;
  }
  console.log(&#39;finished building&#39;);
});</code></pre>
<h3>Example custom Grunt.js plugin, &quot;<code>steps</code>&quot;</h3>
<p>This shows how to create a custom Grunt plugin using Assemble steps. </p>
<pre><code class="lang-js">grunt.registerMultiTask(&#39;steps&#39;, &#39;examples of using steps in assemble&#39;, function() {

  var done = this.async();

  grunt.verbose.writeln((&#39;Running &#39; + this.name + &#39; - &#39; + this.target).cyan);

  // require assemble
  var assemble = require(&#39;assemble&#39;);

  // initalize assemble with the currently running task
  assemble = assemble.init(this);

  // let&#39;s see what assemble has now
  grunt.verbose.writeln(require(&#39;util&#39;).inspect(assemble));
  grunt.verbose.writeln(&#39;&#39;);

  // you can see there are some defaults that assemble sets up
  // add the steps you want to execute

  // add a custom string property to the assemble object
  assemble.step(function(assemble, next) {
    grunt.log.writeln(&#39;running step 1&#39;);
    assemble.step1 = &#39;This is step 1&#39;;
    next(assemble);
  });

  // add a custom object property to the assemble object
  assemble.step(function(assemble, next) {
    grunt.log.writeln(&#39;running step 2&#39;);
    assemble.step2 = {
      data: &#39;This is step 2&#39;
    };
    next(assemble);
  });

  // add a custom array property to the assemble object
  assemble.step(function(assemble, next) {
    grunt.log.writeln(&#39;running step 3&#39;);
    assemble.step3 = [&#39;This is step 3&#39;];
    next(assemble);
  });

  // the last step will use the custom properties set up in the first 3 steps
  assemble.step(function(assemble, next) {
    grunt.log.writeln(&#39;running step 4&#39;);

    grunt.log.writeln(&#39;  data from other steps: &#39;);
    grunt.log.writeln(&#39;    &#39; + assemble.step1);
    grunt.log.writeln(&#39;    &#39; + assemble.step2.data);
    grunt.log.writeln(&#39;    &#39; + assemble.step3[0]);
    grunt.log.writeln(&#39;&#39;);

    next(assemble);
  });

  // now run build
  assemble.build(function(err, results) {
    grunt.log.writeln(&#39;build finished&#39;);
    done();
  });

});</code></pre>
<h3>Example Gruntfile with <code>steps</code> task</h3>
<p>The following code is for an entire <code>Gruntfile.js</code>, with an example of how to use <code>step</code> and <code>build</code> in the simpilest way.</p>
<pre><code class="lang-javascript">module.exports = function(grunt) {

  // Project configuration.
  grunt.initConfig({
    steps: {
      target1: {
        // do something
      },
      target2: {
        // do something else
      }
    }
  });

  // Load npm plugins to provide necessary tasks.
  grunt.loadNpmTasks(&#39;grunt-contrib-jshint&#39;);

  // Default task.
  grunt.registerTask(&#39;default&#39;, [&#39;jshint&#39;, &#39;steps&#39;]);
};</code></pre>

          </div>
        </div>
      </div>
    </div>

    <!-- back-to-top link -->
    <div class="container">
      <a href="#" class="bs-top">
        Back to top
      </a>
    </div>

    <!-- JavaScripts
    ================================================== -->
    <script src="../assets/js/jquery.js"></script>
    <script src="../assets/js/bootstrap.js"></script>
    <script src="../assets/js/highlight.js"></script>
    <script src="../assets/js/holder/holder.js"></script>
    <script src="../assets/js/showup.js"></script>
    <script>
      $().showUp('.navbar');
    </script>
  </body>
</html>
